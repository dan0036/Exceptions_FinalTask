К сожалению, не успел отладить программу. 
Есть проблема с созданием/проходам по массивам, которую не решил и не смог, соответственно, протестировать основной функционал.
Сдаю как есть, так как это лучше, чем ничего(.
